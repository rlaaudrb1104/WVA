<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WVA Tools</title>
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .grid-cell {
        width: 100px;
        height: 100px;
      }
      .cookie-inputs { display: none; }
      .cookie-inputs.active { display: flex; flex-direction: column; gap: 0.5rem; }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-900 font-sans">
    <header class="bg-white shadow shadow-lg relative">
      <nav
        class="container mx-auto px-6 py-3 flex justify-between items-center"
      >
        <a href="/" class="text-3xl font-bold text-lime-600">WVA</a>
        <div class="space-x-4">
          <a
            href="{{ url_for('input_tag_bp.input_tag') }}"
            class="text-gray-500 hover:text-lime-600 font-bold"
            >Site-Info Crawl</a
          >
          <a
            href="{{ url_for('directory_bp.directory') }}"
            class="text-gray-500 hover:text-lime-600 font-bold"
            >File Vulnerability</a
          >
          <a
            href="/SQL_Payload"
            class="text-gray-500 hover:text-lime-600 font-bold"
            >Sql Injection</a
          >
          <a
            href="{{ url_for('XSS_Bypass_bp.XSS') }}"
            class="text-lime-600 font-bold"
            >XSS[B]</a
          >
          <a
            href="xss-p"
            class="text-gray-500 hover:text-lime-600 font-bold"
            >XSS[P]</a
          >
        </div>
      </nav>
    </header>
    <h1 class="font-bold text-lime-600 text-3xl flex justify-center m-5">
      XSS Bypass Vulnerability Check
    </h1>
    <p class="flex justify-center text-gray-500 mt-5 text-center">
      It needs payload and parameter.
    </p>
    <p class="flex justify-center text-gray-500 mb-5 text-center">
      And may needs cookies.
    </p>
    <div class="flex justify-center w-screeen">
      <form id="xssForm" method="post" action="{{ url_for('XSS_Bypass_bp.XSS') }}">
        
        <label for="url" class="my-5 font-bold">Enter URL:</label>
        <div class="relative box-border mt-5 mb-2">
          <input
            class="font-bold border-b-4 border-lime-600 w-96 h-8 rounded-full outline-0 bg-gray-200 px-5"
            type="text"
            id="url"
            name="url"
            required
          />
        </div>

        <label for="params" class="my-5 font-bold">Enter Parameter:</label>
        <div class="relative box-border mt-5 mb-2">
          <input
            class="font-bold border-b-4 border-lime-600 w-96 h-8 rounded-full outline-0 bg-gray-200 px-5"
            type="text"
            id="params"
            name="params"
            required
          />
        </div>

        <fieldset>
          <div class="flex justify-between">
            <legend class="font-bold mb-2">Number of Cookie:</legend>
            <div class="flex items-center gap-2 mb-2">
            <label>
              <input class="md:accent-lime-500" type="radio" name="cookieCount" value="0" checked> 0
            </label>
            <label>
              <input class="md:accent-lime-500" type="radio" name="cookieCount" value="1"> 1
            </label>
            <label>
              <input class="md:accent-lime-500" type="radio" name="cookieCount" value="2"> 2
            </label>
          </div>
          </div>
          <div id="cookieInputsContainer" class="mt-2 mb-5 flex flex-col">
            <div class="cookie-inputs" id="cookieInputs1">
              <input
                class="font-bold border-b-4 border-lime-600 w-full md:w-96 h-8 rounded-full outline-none bg-gray-200 px-5 mb-2"
                type="text"
                placeholder="Cookie Name"
                name="cookie_name1"
                id="cookie_name1"
              />
              <input
                class="font-bold border-b-4 border-lime-600 w-full md:w-96 h-8 rounded-full outline-none bg-gray-200 px-5"
                type="text"
                placeholder="Cookie Value"
                name="cookie_value1"
                id="cookie_value1"
              />
            </div>
            <div class="cookie-inputs mt-5" id="cookieInputs2">
              <input
                class="font-bold border-b-4 border-lime-600 w-full md:w-96 h-8 rounded-full outline-none bg-gray-200 px-5 mb-2"
                type="text"
                placeholder="Cookie Name"
                name="cookie_name2"
                id="cookie_name2"
              />
              <input
                class="font-bold border-b-4 border-lime-600 w-full md:w-96 h-8 rounded-full outline-none bg-gray-200 px-5"
                type="text"
                placeholder="Cookie Value"
                name="cookie_value2"
                id="cookie_value2"
              />
            </div>
          </div>
        </fieldset>
        
        <button
          type="submit"
          class="mb-4 bg-lime-600 font-bold text-gray-100 px-4 py-2 rounded-full hover:shadow hover:shadow-black"
        >
          Submit
        </button>
        <p>
          <a
            href="/"
            class="my-2 bg-lime-600 font-bold text-gray-100 px-4 py-2 rounded-full hover:shadow hover:shadow-black"
            >Go back to Home Page</a
          >
        </p>

        <!--Loading circle animation-->
        <div id="loading" class="hidden animate-spin rounded-full h-20 w-20 border-t-2 border-b-2 border-green-500 mt-16 mx-auto"></div>

      </form>

    </div>
    
    <!--Loading circle animation script-->
    <script>
      document.querySelector('form').addEventListener('submit', function() {
          document.getElementById('loading').classList.remove('hidden');
      });
  </script>

    <!--cookie script-->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('xssForm');
        const cookieCountRadios = form.querySelectorAll('input[name="cookieCount"]');
        const cookieInputsContainer = document.getElementById('cookieInputsContainer');
        const cookieInputs1 = document.getElementById('cookieInputs1');
        const cookieInputs2 = document.getElementById('cookieInputs2');
    
        cookieCountRadios.forEach(radio => {
          radio.addEventListener('change', function () {
            switch (this.value) {
              case '0':
                cookieInputs1.classList.remove('active');
                cookieInputs2.classList.remove('active');
                break;
              case '1':
                cookieInputs1.classList.add('active');
                cookieInputs2.classList.remove('active');
                break;
              case '2':
                cookieInputs1.classList.add('active');
                cookieInputs2.classList.add('active');
                break;
            }
          });
        });
      });
    </script>
    <footer class="mt-12 fixed bottom-0 w-full flex justify-between">
      <img src="{{ url_for('static', filename='img/2024WVA.png') }}", width="200px"></img>
    </footer>
  </body>
</html>
