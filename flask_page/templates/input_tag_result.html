<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WVA Tools</title>
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .grid-cell {
        width: 100px;
        height: 100px;
      }

      .page-info {
        margin-bottom: 20px;
      }

      .hidden {
        display: none;
      }
      .scroll-to-top {
        display: none;
        opacity: 0;
        transition: opacity 0.3s ease-in-out;
      }
      .scroll-to-top.show {
        display: block;
        opacity: 1;
        }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-900 font-sans">

    <!--Top navigation bar-->
    <header class="bg-white shadow shadow-lg relative">
      <nav
        class="container mx-auto px-6 py-3 flex justify-between items-center"
      >
        <a href="/" class="text-3xl font-bold text-lime-600">WVA</a>
        <div class="space-x-4">
          <a
            href="{{ url_for('input_tag_bp.input_tag') }}"
            class="text-gray-500 hover:text-lime-600 font-bold"
            >Site-Info Crawl</a
          >
          <a
            href="/directory-listing"
            class="text-gray-500 hover:text-lime-600 font-bold"
            >File Vulnerability</a
          >
          <a
            href="/sql-injection"
            class="text-gray-500 hover:text-lime-600 font-bold"
            >Sql Injection</a
          >
          <a href="{{ url_for('XSS_Bypass_bp.XSS') }}" class="text-gray-500 hover:text-lime-600 font-bold"
            >XSS</a
          >
        </div>
      </nav>
    </header>
    
    <!--Body contents-->
    <h1 class="font-bold text-lime-600 text-3xl flex justify-center m-5">
      Site-Info Crawl Result
    </h1>
    <p class="flex justify-center text-gray-500">
      Result of crawling the site with the dfs algorithm.
    </p>
    <div class="flex flex-row justify-center">
      <div class="flex flex-col mx-5 justify-center">
        <a
          href="/input_tag"
          class="hover:bg-lime-800 my-2 bg-lime-600 font-bold text-gray-100 px-4 py-2 rounded-full hover:shadow hover:shadow-black justify-center text-center"
          >Go back to Site-Info Crawl Page</a
        >
        <a
          href="/"
          class="hover:bg-lime-800 mt-2 mb-4 bg-lime-600 font-bold text-gray-100 px-4 py-2 rounded-full hover:shadow hover:shadow-black justify-center text-center"
          >Go back to Home Page</a
        >
      </div>
    </div>
    <hr  />
    <br  />

    <!--page info toggles-->
    {% for page_info in pages_info %}
    <div class="page-info">
      <details class="border-2 border-lime-300 bg-lime-100 rounded-md mx-10"><summary class="font-bold text-lg rounded-md py-2 mx-10 cursor-pointer" 
        onclick="toggleContent('content_{{ loop.index }}')">
        ‚ñ´Ô∏è {{ page_info['url'] }}
        </summary>
        <div id="content_{{ loop.index }}" class="hidden bg-lime-100 border-lime-200 p-2 rounded-md mx-10">
          
          <!--Hyperlink-->
          <a href="{{ page_info['url'] }}" target="_blank" rel="noopener noreferrer" class="mx-2 pl-1 pr-2 my-2 border-4 rounded-md border-lime-300 bg-lime-300 "><strong>üîó Go to </strong> {{ page_info['url'] }}</a>
          
          <!--CSP & Security header-->
          <div class="mx-5">
            <details>
              <summary class="my-2 font-bold cursor-pointer">üîè Security header</summary>
              {% if page_info['security_headers'] %}
                <p class="mb-2 mx-5">{% for header, value in page_info['security_headers'].items() %}
                  <p class="mx-5 mb-1">
                    <div class="border-2 border-lime-500 max-w-fit font-bold bg-lime-200 rounded-md pr-1">
                      üçÄ {{ header }}: {{ value }}
                    </div>
                  </p>
                  {% endfor %}
                </p>
            </details> {% else %}
              <p class="mb-4 mx-5">Security header is missing or not found.</p>
            </details>
              {% endif %}
          </div>

          <!--Input tag-->
          <div class="mx-5">
            <details><summary class="my-2 font-bold cursor-pointer">‚úèÔ∏è Input Tags</summary>
            {% if page_info['input_tags'] %} {% for input_tag in
            page_info['input_tags'] %}
            <p class="my-2 mx-5">üçÄ {{ input_tag }}</p>
            {% endfor %}</details> {% else %}
            <p class="mb-4 mx-5">No Input Tags found.</p></details>
            {% endif %}
          </div>
  
          <!--Comments-->
          <div class="mx-5">
            <details><summary class="my-2 font-bold cursor-pointer">üìí Comments</summary>
            {% if page_info['comments'] %} {% for comment in page_info['comments']
            %}
            <p class="mb-4 mx-5">üçÄ {{ comment }}</p>
            {% endfor %}</details> {% else %}
            <p class="mb-4 mx-5">No Comments found.</p></details>
            {% endif %}
          </div>
  
          <!--Form method-->
          <div class="mx-5">
            <details><summary class="my-2 font-bold cursor-pointer">üí¨ Form Method</summary>
            {% if page_info['forms'] %} {% for form_info in page_info['forms']
            %}
            <div class="mb-5">
              <p class="font-bold mb-2">‚ñ™Ô∏è Form Action: {{ form_info['action'] }}</p>
              <p class="font-bold mb-2">‚ñ™Ô∏è Method: {{ form_info['method'] }}</p>
  
              <div class="flex flex-col mx-5">
  
                <!--GET request toggle-->
                <div>
                  <details class="mb-5 mx-5">
                    <summary class="text-md mb-2 font-bold">GET Request</summary>
                      <p class="font-bold mb-2">‚ñ™Ô∏è Status Code: [ {{ form_info['response']['GET']['status_code'] }} ]</p>
                      <div class="font-bold">‚ñ™Ô∏è Response Content: </div>
                      <div class="border-y-4 border-lime-500 rounded-lg m-5">
                        <p class="overflow-auto max-w-fit max-h-48 p-2 m-1">
                          {{ form_info['response']['GET']['content'] }}
                        </p>
                      </div>
                  </details>
                </div>
                
                <!--POST request toggle-->
                <div>
                  <details class="mx-5 mb-5">
                    <summary class="text-md mb-2 font-bold">POST Request</summary>
                      <p class="font-bold mb-2">‚ñ™Ô∏è Status Code: [ {{ form_info['response']['POST']['status_code'] }} ]</p>
                      <div class="font-bold">‚ñ™Ô∏è Response Content: </div>
                      <div class="border-y-4 border-lime-500 rounded-lg m-5">
                        <p class="overflow-auto max-w-fit max-h-48 p-2 m-1">
                          {{ form_info['response']['POST']['content'] }}
                        </p>
                      </div>
                  </details>
                </div>
                <hr class="border-2 border-lime-500 border-dashed"/>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <p>No forms found.</p>
          {% endif %}
  
        </div>
      </details>
      
    </div>
    {% endfor %}

    <!--Toggle script-->
    <script>
      function toggleContent(id) {
        var content = document.getElementById(id)
        content.classList.toggle("hidden")
      }
    </script>
    <img src="{{ url_for('static', filename='img/Arrow.png') }}" class="rounded-full cursor-pointer fixed bottom-5 right-4 animate-bounce size-16 scroll-to-top" onclick="javascript:window.scrollTo(0,0);">
    <script>
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                document.querySelector('.scroll-to-top').classList.add('show');
            } else {
                document.querySelector('.scroll-to-top').classList.remove('show');
            }
        }
    </script>
  </body>
    
</html>
